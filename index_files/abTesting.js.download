(function(l){var a={listeners:[],count:0,doc:l.document,mainContainer:l.document.querySelector(".mako_main_main_containter")||l.document.querySelector(".magazineWrapper")||l.document.querySelector("#jqt #content")||l.document.querySelector("main"),MutationObserver:l.MutationObserver||l.WebKitMutationObserver,observer:null,log:function(b){window.console&&console.log((new Date).getTime()+" ::: "+b)},clearLogIfNeeded:function(){-1==location.href.indexOf("ablog=true")&&(a.log=function(){})},init:function(b){a.log("init started");
a.storageName="mako_abtest_saved";a.abTests=b;a.abTests2Ordering={};a.platform=a.getPlatform();a.testsToss=JSON.parse(localStorage.getItem(a.storageName)||"{}");a.log("init done")},isMobile:function(){return"mobile"==a.platform},getPlatform:function(){var b=location.hostname;return-1==b.indexOf("mobile.")&&-1==b.indexOf("m.")&&-1==location.href.indexOf("AjaxPage")?"www":"mobile"},prepare4Swap:function(){a.log("prepare4Swap started");for(var b=this.abTests.length,c=0;c<b;c++){var d=a.abTests[c];d.isTestRunning=
100>d.progress[a.platform];if(d.isTestRunning)var f=a.tossNumber(d);else delete a.testsToss[d.test_id],f=a.getWinnerIndex(d);d.masterVariantIndex=a.getMasterIndex(d);if(f!=d.masterVariantIndex||d.isTestRunning){var e=d.orderingName;e&&(a.abTests2Ordering[e]||(a.abTests2Ordering[e]=[]),d.testVariantWinner=f,a.abTests2Ordering[e].push(d))}}localStorage.setItem(a.storageName,JSON.stringify(a.testsToss));a.log("prepare4Swap done")},tossNumber:function(b){var c=a.testsToss[b.test_id];"number"!=typeof c&&
(c=b.test_variants.length,c=window.crypto||window.msCrypto?crypto.getRandomValues(new Uint16Array(1))[0]%c:Math.floor(Math.random()*c));return a.testsToss[b.test_id]=c},getWinnerIndex:function(b){for(var c=-1,d=-1,f=b.test_variants.length,e=0;e<f;e++){var g=parseInt(b.test_variants[e].clicks[a.platform]);g>d&&(d=g,c=e)}if(-1==c)throw"missing Winner in test"+b.test_id+"!!!";return c},getMasterIndex:function(b){for(var c=b.test_variants.length,d=0;d<c;d++)if("true"==b.test_variants[d].ismaster)return d;
throw"missing Master variant in test"+b.test_id+"!!!";},isBrowserSupported:function(){try{return localStorage.setItem("testStorage","testStorage"),localStorage.removeItem("testStorage"),!!MutationObserver}catch(b){return!1}},ready:function(b,c){a.listeners.push({selector:b,fn:c,found:0});a.observer||(a.observer=new MutationObserver(a.check),a.observer.observe(a.mainContainer,{childList:!0,subtree:!0}))},check:function(){a.log("counting "+a.count++);for(var b=[],c=0,d=a.listeners.length,f,e;c<d;c++){f=
a.listeners[c];e=a.mainContainer.querySelectorAll(f.selector);for(var g=0,m=e.length,h;g<m;g++){h=e[g];var k=!a.isMobile()&&'[box-title="\u05e1\u05dc\u05d9\u05d9\u05d3\u05e8 \u05e8\u05d0\u05e9\u05d9"]'==f.selector;h.ready||!h.nextSibling&&!k||(h.ready=!k||h.nextSibling,f.fn.call(h,h),(k&&h.nextSibling||!k&&('[box-title="\u05de\u05d0\u05e7\u05d5 \u05e4\u05d9\u05d3"]'!=f.selector||1<++f.found))&&b.push(c))}}c=b.length;b.sort(function(n,p){return p-n});if(0<b.length)for(g=0;g<c;g++)d=b[g],a.log("removing listener "+
a.listeners[d].selector),a.listeners.splice(d,1);if(0==a.listeners.length||"complete"==a.doc.readyState)a.observer.disconnect(),a.log("observer disconnected");a.log("counting "+a.count+"done")},checkCallback:function(b){for(var c=a.abTests2Ordering,d=0,f=c[b].length;d<f;d++){var e=c[b][d],g=this.querySelectorAll('[data-teaser-vcmid="'+e.teaser_vcm_id+'"][data-item-vcmid="'+e.item_vcm_id+'"]');a.swapTest(g,e)}},createCallback:function(b){return function(){return a.checkCallback.call(this,b)}},makeTheSwitch:function(){try{a.log("makeTheSwitch started");
var b=Object.keys(a.abTests2Ordering),c=b.length;if(0<c)for(var d=0;d<c;d++){var f=b[d];a.ready('[box-title="'+f.replace('"',"")+'"]',a.createCallback(f))}}catch(e){window.console&&console.error(e.message)}a.log("makeTheSwitch done")},swapTest:function(b,c){a.log("swap began for:"+c.test_id+",found:"+b.length+" objs");for(var d=0,f=b.length;d<f;d++){var e=b[d];if(!e.ready&&(e.nextSibling||e.parentNode.nextSibling)){e.ready=!0;var g=e.dataset.imageType,m=e.querySelectorAll('[data-type="title"]'),h=
e.querySelector('[data-type="image"] img')||e.querySelector("img"),k=c.test_variants[c.testVariantWinner],n=k.image_urls["image_url_"+g],p=k.title;g=k.subtitle;if(m[0]&&p){a.log("swap started for:"+k.variant_id);if(c.testVariantWinner!=c.masterVariantIndex){a.handleCloningElement(m,p);h&&n&&(a.isMobile()?h.removeAttribute("data-original"):h.title=k.pictureAlt?k.pictureAlt:"",h.src="",h.src=n);var q=e.querySelector(".inner .element");m=e.querySelector('[data-type="subtitle"]');q&&(h=k.image_urls.image_url_b,
n=k.image_urls.image_url_i,m=q.querySelector('[itemprop="description"]'),p=q.querySelector('[itemprop="thumbnailUrl"]'),q=q.querySelector('[itemprop="image"]'),h&&p&&(p.innerHTML=h),n&&q&&(q.innerHTML=n));g&&m&&(m.innerHTML=g)}if(c.isTestRunning)for(e=e.querySelectorAll("a"),g=0,m=e.length;g<m;g++)e[g].href=e[g].href.replace(/(pId=\d+)/g,"$1_"+k.variant_id);a.log("swap done for:"+k.variant_id)}}}},handleCloningElement:function(b,c){var d=c.split("\n");if(b[0].getAttribute("isMultiple")){for(var f=
0,e=d.length;f<e;f++)if(b[f])b[f].childNodes[0].textContent=d[f];else{var g=b[0].cloneNode(!0);g.childNodes[0].textContent=d[f];b[0].parentNode.innerHTML+=g.outerHTML}for(e=b.length;f<e;f++)b[f].remove()}else b[0].innerHTML=c},process:function(b){try{a.clearLogIfNeeded(),a.isBrowserSupported()&&(a.init(b),a.prepare4Swap(),a.makeTheSwitch(),a.log("DDDone"))}catch(c){a.log(c.message)}}};l.ABtesting=a})(this);function hello(l){alert("Hello, "+l)}hello("New user");